<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A full- and high-speed `UsbBus` implementation"><meta name="keywords" content="rust, rustlang, rust-lang, BusAdapter"><title>BusAdapter in imxrt_usbd - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../imxrt_usbd/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../imxrt_usbd/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">BusAdapter</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><ul><li><a href="#method.borrow_gpt">borrow_gpt</a></li><li><a href="#method.configure">configure</a></li><li><a href="#method.enable_zlt">enable_zlt</a></li><li><a href="#method.gpt_mut">gpt_mut</a></li><li><a href="#method.new">new</a></li><li><a href="#method.set_interrupts">set_interrupts</a></li><li><a href="#method.with_speed">with_speed</a></li><li><a href="#method.without_critical_sections">without_critical_sections</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#trait-implementations">Trait Implementations</a></h3><ul><li><a href="#impl-UsbBus-for-BusAdapter">UsbBus</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><ul><li><a href="#impl-RefUnwindSafe-for-BusAdapter">!RefUnwindSafe</a></li><li><a href="#impl-Send-for-BusAdapter">Send</a></li><li><a href="#impl-Sync-for-BusAdapter">Sync</a></li><li><a href="#impl-Unpin-for-BusAdapter">Unpin</a></li><li><a href="#impl-UnwindSafe-for-BusAdapter">!UnwindSafe</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#blanket-implementations">Blanket Implementations</a></h3><ul><li><a href="#impl-Any-for-BusAdapter">Any</a></li><li><a href="#impl-Borrow%3CT%3E-for-BusAdapter">Borrow&lt;T&gt;</a></li><li><a href="#impl-BorrowMut%3CT%3E-for-BusAdapter">BorrowMut&lt;T&gt;</a></li><li><a href="#impl-From%3CT%3E-for-BusAdapter">From&lt;T&gt;</a></li><li><a href="#impl-Into%3CU%3E-for-BusAdapter">Into&lt;U&gt;</a></li><li><a href="#impl-TryFrom%3CU%3E-for-BusAdapter">TryFrom&lt;U&gt;</a></li><li><a href="#impl-TryInto%3CU%3E-for-BusAdapter">TryInto&lt;U&gt;</a></li></ul></div></section><h2 class="location"><a href="index.html">In imxrt_usbd</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../imxrt_usbd/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Struct <a href="index.html">imxrt_usbd</a>::<wbr><a class="struct" href="#">BusAdapter</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/imxrt_usbd/bus.rs.html#108-111">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust struct"><code>pub struct BusAdapter { /* private fields */ }</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A full- and high-speed <code>UsbBus</code> implementation</p>
<p>The <code>BusAdapter</code> adapts the USB peripheral instances, and exposes a <code>UsbBus</code> implementation.</p>
<h2 id="requirements"><a href="#requirements">Requirements</a></h2>
<p>The driver assumes that you’ve prepared all USB clocks (CCM clock gates, CCM analog PLLs).</p>
<p>Before polling for USB class traffic, you must call <a href="struct.BusAdapter.html#method.configure"><code>configure()</code></a>
<em>after</em> your device has been configured. This can be accomplished by polling the USB
device and checking its state until it’s been configured. Once configured, use <code>UsbDevice::bus()</code>
to access the i.MX RT <code>BusAdapter</code>, and call <code>configure()</code>. You should only do this once.
After that, you may poll for class traffic.</p>
<h2 id="example"><a href="#example">Example</a></h2>
<p>This example shows you how to create a <code>BusAdapter</code>, build a simple USB device, and
prepare the device for class traffic.</p>
<p>Note that this example does not demonstrate USB class allocation or polling. See
your USB class’ documentation for details. This example also skips the clock initialization.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>imxrt_usbd::BusAdapter;

<span class="kw">static </span><span class="kw-2">mut </span>ENDPOINT_MEMORY: [u8; <span class="number">1024</span>] = [<span class="number">0</span>; <span class="number">1024</span>];

<span class="comment">// TODO initialize clocks...

</span><span class="kw">let </span>my_usb_peripherals = <span class="comment">// Your Peripherals instance...
</span><span class="kw">let </span>bus_adapter = BusAdapter::new(
    my_usb_peripherals,
    <span class="kw">unsafe </span>{ <span class="kw-2">&amp;mut </span>ENDPOINT_MEMORY }
);

<span class="comment">// Create the USB device...
</span><span class="kw">use </span>usb_device::prelude::<span class="kw-2">*</span>;
<span class="kw">let </span>bus_allocator = usb_device::bus::UsbBusAllocator::new(bus_adapter);
<span class="kw">let </span><span class="kw-2">mut </span>device = UsbDeviceBuilder::new(<span class="kw-2">&amp;</span>bus_allocator, UsbVidPid(<span class="number">0x5824</span>, <span class="number">0x27dd</span>))
    .product(<span class="string">&quot;imxrt-usbd&quot;</span>)
    <span class="comment">// Other builder methods...
    </span>.build();

<span class="comment">// Poll until configured...
</span><span class="kw">loop </span>{
    <span class="kw">if </span>device.poll(<span class="kw-2">&amp;mut </span>[]) {
        <span class="kw">let </span>state = device.state();
        <span class="kw">if </span>state == usb_device::device::UsbDeviceState::Configured {
            <span class="kw">break</span>;
        }
    }
}

<span class="comment">// Configure the bus
</span>device.bus().configure();

<span class="comment">// Ready for class traffic!</span></code></pre></div>
<h2 id="design"><a href="#design">Design</a></h2>
<p>This section talks about the driver design. It assumes that
you’re familiar with the details of the i.MX RT USB peripheral. If you
just want to use the driver, you can skip this section.</p>
<h3 id="packets-and-transfers"><a href="#packets-and-transfers">Packets and transfers</a></h3>
<p>All i.MX RT USB drivers manage queue heads (QH), and transfer
descriptors (TD). For the driver, each (QH) is assigned
only one (TD) to perform I/O. We then assume each TD describes a single
packet. This is simple to implement, but it means that the
driver can only have one packet in flight per endpoint. You’re expected
to quickly respond to <code>poll()</code> outputs, and schedule the next transfer
in the time required for devices. This becomes more important as you
increase driver speeds.</p>
<p>The hardware can zero-length terminate (ZLT) packets as needed if you
call <a href="struct.BusAdapter.html#method.enable_zlt"><code>enable_zlt</code></a>. By default, this feature is
off, because most <code>usb-device</code> classes / devices take care to send zero-length
packets, and enabling this feature could interfere with the class / device
behaviors.</p>
</div></details><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><div id="implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#113-277">source</a><a href="#impl-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.new" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#118-120">source</a><h4 class="code-header">pub fn <a href="#method.new" class="fnname">new</a>&lt;P:&nbsp;<a class="trait" href="trait.Peripherals.html" title="trait imxrt_usbd::Peripherals">Peripherals</a>&gt;(peripherals: P, buffer: &amp;'static mut [<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>]) -&gt; Self</h4></section></summary><div class="docblock"><p>Create a high-speed USB bus adapter</p>
<p>This is equivalent to <a href="struct.BusAdapter.html#method.with_speed" title="BusAdapter::with_speed"><code>BusAdapter::with_speed</code></a> when supplying <a href="enum.Speed.html#variant.High" title="Speed::High"><code>Speed::High</code></a>. See
the <code>with_speed</code> documentation for more information.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.with_speed" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#134-140">source</a><h4 class="code-header">pub fn <a href="#method.with_speed" class="fnname">with_speed</a>&lt;P:&nbsp;<a class="trait" href="trait.Peripherals.html" title="trait imxrt_usbd::Peripherals">Peripherals</a>&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;peripherals: P,<br>&nbsp;&nbsp;&nbsp;&nbsp;buffer: &amp;'static mut [<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>],<br>&nbsp;&nbsp;&nbsp;&nbsp;speed: <a class="enum" href="enum.Speed.html" title="enum imxrt_usbd::Speed">Speed</a><br>) -&gt; Self</h4></section></summary><div class="docblock"><p>Create a USB bus adapter with the given speed</p>
<p>Specify <a href="enum.Speed.html#variant.LowFull" title="Speed::LowFull"><code>Speed::LowFull</code></a> to throttle the USB data rate.</p>
<p>When this function returns, the <code>BusAdapter</code> has initialized the PHY and USB core peripherals.
The adapter expects to own these two peripherals, along with the other peripherals required
by the <a href="trait.Peripherals.html"><code>Peripherals</code></a> safety contract.</p>
<p>You must also provide a region of memory that will used for endpoint I/O. The
memory region will be partitioned for the endpoints, based on their requirements.</p>
<p>You must ensure that no one else is using the endpoint memory!</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.without_critical_sections" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#152-163">source</a><h4 class="code-header">pub unsafe fn <a href="#method.without_critical_sections" class="fnname">without_critical_sections</a>&lt;P:&nbsp;<a class="trait" href="trait.Peripherals.html" title="trait imxrt_usbd::Peripherals">Peripherals</a>&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;peripherals: P,<br>&nbsp;&nbsp;&nbsp;&nbsp;buffer: &amp;'static mut [<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>],<br>&nbsp;&nbsp;&nbsp;&nbsp;speed: <a class="enum" href="enum.Speed.html" title="enum imxrt_usbd::Speed">Speed</a><br>) -&gt; Self</h4></section></summary><div class="docblock"><p>Create a USB bus adapter that never takes a critical section</p>
<p>See <a href="struct.BusAdapter.html#method.with_speed" title="BusAdapter::with_speed"><code>BusAdapter::with_speed</code></a> for general information.</p>
<h5 id="safety"><a href="#safety">Safety</a></h5>
<p>The returned object fakes its <code>Sync</code> safety. Specifically, the object
will not take critical sections in its <code>&amp;[mut] self</code> methods to ensure safe
access. By using this object, you must manually hold the guarantees of
<code>Sync</code> without the compiler’s help.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.set_interrupts" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#185-187">source</a><h4 class="code-header">pub fn <a href="#method.set_interrupts" class="fnname">set_interrupts</a>(&amp;self, interrupts: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.bool.html">bool</a>)</h4></section></summary><div class="docblock"><p>Enable (<code>true</code>) or disable (<code>false</code>) interrupts for this USB peripheral</p>
<p>The interrupt causes are implementation specific. To handle the interrupt,
call <a href="struct.BusAdapter.html#method.poll"><code>poll()</code></a>.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.enable_zlt" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#201-203">source</a><h4 class="code-header">pub fn <a href="#method.enable_zlt" class="fnname">enable_zlt</a>(&amp;self, ep_addr: EndpointAddress)</h4></section></summary><div class="docblock"><p>Enable zero-length termination (ZLT) for the given endpoint</p>
<p>When ZLT is enabled, software does not need to send a zero-length packet
to terminate a transfer where the number of bytes equals the max packet size.
The hardware will send this zero-length packet itself. By default, ZLT is off,
and software is expected to send these packets. Enable this if you’re confident
that your (third-party) device / USB class isn’t already sending these packets.</p>
<h5 id="panics"><a href="#panics">Panics</a></h5>
<p><code>enable_zlt</code> must be called before the endpoint is allocated. If the endpoint is
already allocated, this call panics.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.configure" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#238-243">source</a><h4 class="code-header">pub fn <a href="#method.configure" class="fnname">configure</a>(&amp;self)</h4></section></summary><div class="docblock"><p>Apply device configurations, and perform other post-configuration actions</p>
<p>You must invoke this once, and only after your device has been configured. If
the device is reset and reconfigured, you must invoke <code>configure()</code> again. See
the top-level example for how this could be achieved.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.borrow_gpt" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#256-264">source</a><h4 class="code-header">pub fn <a href="#method.borrow_gpt" class="fnname">borrow_gpt</a>&lt;R&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;cs: &amp;CriticalSection,<br>&nbsp;&nbsp;&nbsp;&nbsp;instance: <a class="enum" href="gpt/enum.Instance.html" title="enum imxrt_usbd::gpt::Instance">Instance</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;func: impl <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(&amp;mut <a class="struct" href="gpt/struct.Gpt.html" title="struct imxrt_usbd::gpt::Gpt">Gpt</a>&lt;'_&gt;) -&gt; R<br>) -&gt; R</h4></section></summary><div class="docblock"><p>Acquire one of the GPT timer instances.</p>
<p><code>instance</code> identifies which GPT instance you’re accessing.
<code>gpt</code> requires a critical section to guarantee a single
mutable access to a USB GPT. See <code>cortex_m::interrupt::free</code>
for more information.</p>
<h5 id="panics-1"><a href="#panics-1">Panics</a></h5>
<p>Panics if the GPT instance is already borrowed. This could happen
if you call <code>borrow_gpt</code> again within the <code>func</code> callback.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.gpt_mut" class="method has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#274-276">source</a><h4 class="code-header">pub fn <a href="#method.gpt_mut" class="fnname">gpt_mut</a>&lt;R&gt;(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self,<br>&nbsp;&nbsp;&nbsp;&nbsp;instance: <a class="enum" href="gpt/enum.Instance.html" title="enum imxrt_usbd::gpt::Instance">Instance</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;func: impl <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(&amp;mut <a class="struct" href="gpt/struct.Gpt.html" title="struct imxrt_usbd::gpt::Gpt">Gpt</a>&lt;'_&gt;) -&gt; R<br>) -&gt; R</h4></section></summary><div class="docblock"><p>Acquire one of the GPT timer instances.</p>
<p><code>instance</code> identifies which GPT instance you’re accessing.</p>
<h5 id="panics-2"><a href="#panics-2">Panics</a></h5>
<p>Panics if the GPT instance is already borrowed. This could happen
if you call <code>borrow_gpt</code> again within the <code>func</code> callback.</p>
</div></details></div></details></div><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor"></a></h2><div id="trait-implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><section id="impl-UsbBus-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#279-416">source</a><a href="#impl-UsbBus-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl UsbBus for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedconstant.QUIRK_SET_ADDRESS_BEFORE_STATUS" class="associatedconstant trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#286">source</a><a href="#associatedconstant.QUIRK_SET_ADDRESS_BEFORE_STATUS" class="anchor"></a><h4 class="code-header">const <a class="constant">QUIRK_SET_ADDRESS_BEFORE_STATUS</a>: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.bool.html">bool</a> = true</h4></section></summary><div class="docblock"><p>The USB hardware can guarantee that we set the status before we receive
the status, and we’re taking advantage of that. We expect this flag to
result in a call to set_address before the status happens. This means
that we can meet the timing requirements without help from software.</p>
<p>It’s not a quirk; it’s a feature :)</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.alloc_ep" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#288-321">source</a><a href="#method.alloc_ep" class="anchor"></a><h4 class="code-header">fn <a class="fnname">alloc_ep</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;mut self,<br>&nbsp;&nbsp;&nbsp;&nbsp;ep_dir: UsbDirection,<br>&nbsp;&nbsp;&nbsp;&nbsp;ep_addr: <a class="enum" href="https://doc.rust-lang.org/1.65.0/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;EndpointAddress&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;ep_type: EndpointType,<br>&nbsp;&nbsp;&nbsp;&nbsp;max_packet_size: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u16.html">u16</a>,<br>&nbsp;&nbsp;&nbsp;&nbsp;_interval: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a><br>) -&gt; Result&lt;EndpointAddress&gt;</h4></section></summary><div class='docblock'>Allocates an endpoint and specified endpoint parameters. This method is called by the device
and class implementations to allocate endpoints, and can only be called before
<a href="UsbBus::enable"><code>enable</code></a> is called. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.set_device_address" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#323-327">source</a><a href="#method.set_device_address" class="anchor"></a><h4 class="code-header">fn <a class="fnname">set_device_address</a>(&amp;self, addr: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>)</h4></section></summary><div class='docblock'>Sets the device USB address to <code>addr</code>.</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.enable" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#329-331">source</a><a href="#method.enable" class="anchor"></a><h4 class="code-header">fn <a class="fnname">enable</a>(&amp;mut self)</h4></section></summary><div class='docblock'>Enables and initializes the USB peripheral. Soon after enabling the device will be reset, so
there is no need to perform a USB reset in this method. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.reset" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#333-337">source</a><a href="#method.reset" class="anchor"></a><h4 class="code-header">fn <a class="fnname">reset</a>(&amp;self)</h4></section></summary><div class='docblock'>Called when the host resets the device. This will be soon called after
<a href="crate::device::UsbDevice::poll"><code>poll</code></a> returns [<code>PollResult::Reset</code>]. This method should
reset the state of all endpoints and peripheral flags back to a state suitable for
enumeration, as well as ensure that all endpoints previously allocated with alloc_ep are
initialized as specified. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.write" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#339-364">source</a><a href="#method.write" class="anchor"></a><h4 class="code-header">fn <a class="fnname">write</a>(&amp;self, ep_addr: EndpointAddress, buf: &amp;[<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>]) -&gt; Result&lt;<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class='docblock'>Writes a single packet of data to the specified endpoint and returns number of bytes
actually written. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.read" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#366-391">source</a><a href="#method.read" class="anchor"></a><h4 class="code-header">fn <a class="fnname">read</a>(&amp;self, ep_addr: EndpointAddress, buf: &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.u8.html">u8</a>]) -&gt; Result&lt;<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.usize.html">usize</a>&gt;</h4></section></summary><div class='docblock'>Reads a single packet of data from the specified endpoint and returns the actual length of
the packet. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.set_stalled" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#393-399">source</a><a href="#method.set_stalled" class="anchor"></a><h4 class="code-header">fn <a class="fnname">set_stalled</a>(&amp;self, ep_addr: EndpointAddress, stalled: <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.bool.html">bool</a>)</h4></section></summary><div class='docblock'>Sets or clears the STALL condition for an endpoint. If the endpoint is an OUT endpoint, it
should be prepared to receive data again. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.is_stalled" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#401-403">source</a><a href="#method.is_stalled" class="anchor"></a><h4 class="code-header">fn <a class="fnname">is_stalled</a>(&amp;self, ep_addr: EndpointAddress) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.bool.html">bool</a></h4></section></summary><div class='docblock'>Gets whether the STALL condition is set for an endpoint.</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.suspend" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#405-407">source</a><a href="#method.suspend" class="anchor"></a><h4 class="code-header">fn <a class="fnname">suspend</a>(&amp;self)</h4></section></summary><div class='docblock'>Causes the USB peripheral to enter USB suspend mode, lowering power consumption and
preparing to detect a USB wakeup event. This will be called after
<a href="crate::device::UsbDevice::poll"><code>poll</code></a> returns [<code>PollResult::Suspend</code>]. The device will
continue be polled, and it shall return a value other than <code>Suspend</code> from <code>poll</code> when it no
longer detects the suspend condition. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.resume" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#409-411">source</a><a href="#method.resume" class="anchor"></a><h4 class="code-header">fn <a class="fnname">resume</a>(&amp;self)</h4></section></summary><div class='docblock'>Resumes from suspend mode. This may only be called after the peripheral has been previously
suspended. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.poll" class="method trait-impl has-srclink"><a class="srclink rightside" href="../src/imxrt_usbd/bus.rs.html#413-415">source</a><a href="#method.poll" class="anchor"></a><h4 class="code-header">fn <a class="fnname">poll</a>(&amp;self) -&gt; PollResult</h4></section></summary><div class='docblock'>Gets information about events and incoming data. Usually called in a loop or from an
interrupt handler. See the [<code>PollResult</code>] struct for more information. <a>Read more</a></div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.force_reset" class="method trait-impl has-srclink"><a href="#method.force_reset" class="anchor"></a><h4 class="code-header">fn <a class="fnname">force_reset</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.65.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.unit.html">()</a>, UsbError&gt;</h4></section></summary><div class='docblock'>Simulates a disconnect from the USB bus, causing the host to reset and re-enumerate the
device. <a>Read more</a></div></details></div></details></div><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor"></a></h2><div id="synthetic-implementations-list"><section id="impl-RefUnwindSafe-for-BusAdapter" class="impl has-srclink"><a href="#impl-RefUnwindSafe-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl !<a class="trait" href="https://doc.rust-lang.org/1.65.0/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section><section id="impl-Send-for-BusAdapter" class="impl has-srclink"><a href="#impl-Send-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section><section id="impl-Sync-for-BusAdapter" class="impl has-srclink"><a href="#impl-Sync-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section><section id="impl-Unpin-for-BusAdapter" class="impl has-srclink"><a href="#impl-Unpin-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section><section id="impl-UnwindSafe-for-BusAdapter" class="impl has-srclink"><a href="#impl-UnwindSafe-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl !<a class="trait" href="https://doc.rust-lang.org/1.65.0/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.BusAdapter.html" title="struct imxrt_usbd::BusAdapter">BusAdapter</a></h3></section></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor"></a></h2><div id="blanket-implementations-list"><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Any-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/any.rs.html#200">source</a><a href="#impl-Any-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.type_id" class="method trait-impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/any.rs.html#201">source</a><a href="#method.type_id" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/any/trait.Any.html#tymethod.type_id" class="fnname">type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.65.0/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></section></summary><div class='docblock'>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/1.65.0/core/any/trait.Any.html#tymethod.type_id">Read more</a></div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Borrow%3CT%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/borrow.rs.html#209">source</a><a href="#impl-Borrow%3CT%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.borrow" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/91522" title="Tracking issue for const_borrow">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/borrow.rs.html#211">source</a></span><a href="#method.borrow" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.Borrow.html#tymethod.borrow" class="fnname">borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.reference.html">&amp;</a>T</h4></section></summary><div class='docblock'>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-BorrowMut%3CT%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/borrow.rs.html#218">source</a><a href="#impl-BorrowMut%3CT%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/1.65.0/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.borrow_mut" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/91522" title="Tracking issue for const_borrow">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/borrow.rs.html#219">source</a></span><a href="#method.borrow_mut" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fnname">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.65.0/core/primitive.reference.html">&amp;mut </a>T</h4></section></summary><div class='docblock'>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/1.65.0/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-From%3CT%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#559">source</a><a href="#impl-From%3CT%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.from" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#562">source</a></span><a href="#method.from" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.From.html#tymethod.from" class="fnname">from</a>(t: T) -&gt; T</h4></section></summary><div class="docblock"><p>Returns the argument unchanged.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-Into%3CU%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#543">source</a><a href="#impl-Into%3CU%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><section id="method.into" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#551">source</a></span><a href="#method.into" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.Into.html#tymethod.into" class="fnname">into</a>(self) -&gt; U</h4></section></summary><div class="docblock"><p>Calls <code>U::from(self)</code>.</p>
<p>That is, this conversion is whatever the implementation of
<code><a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.From.html" title="From">From</a>&lt;T&gt; for U</code> chooses to do.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-TryFrom%3CU%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#601">source</a><a href="#impl-TryFrom%3CU%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedtype.Error" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.Error" class="anchor"></a><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="https://doc.rust-lang.org/1.65.0/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.try_from" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#607">source</a></span><a href="#method.try_from" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html#tymethod.try_from" class="fnname">try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.65.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details><details class="rustdoc-toggle implementors-toggle"><summary><section id="impl-TryInto%3CU%3E-for-BusAdapter" class="impl has-srclink"><a class="srclink rightside" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#586">source</a><a href="#impl-TryInto%3CU%3E-for-BusAdapter" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,</span></h3></section></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><section id="associatedtype.Error-1" class="associatedtype trait-impl has-srclink"><a href="#associatedtype.Error-1" class="anchor"></a><h4 class="code-header">type <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></section></summary><div class='docblock'>The type returned in the event of a conversion error.</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="method.try_into" class="method trait-impl has-srclink"><span class="rightside"><span class="since" title="const unstable">const: <a href="https://github.com/rust-lang/rust/issues/88674" title="Tracking issue for const_convert">unstable</a></span> · <a class="srclink" href="https://doc.rust-lang.org/1.65.0/src/core/convert/mod.rs.html#592">source</a></span><a href="#method.try_into" class="anchor"></a><h4 class="code-header">fn <a href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryInto.html#tymethod.try_into" class="fnname">try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.65.0/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="https://doc.rust-lang.org/1.65.0/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></section></summary><div class='docblock'>Performs the conversion.</div></details></div></details></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="imxrt_usbd" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.65.0 (897e37553 2022-11-02)" ></div></body></html>